<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Cek Rekening - Storepanda</title>
  <script src="https://cdn.tailwindcss.com"></script> <!-- TailwindCSS CDN -->
</head>
<body class="min-h-screen bg-gray-100 flex items-center justify-center p-6">
  <div class="bg-white p-8 rounded-xl shadow-xl w-full max-w-md">
    <h2 class="text-2xl font-bold mb-4 text-center text-indigo-600">üîç Cek Info Rekening</h2>

    <label for="bank" class="block font-semibold mb-1">Pilih Bank:</label>
    <select id="bank" class="w-full p-2 mb-4 border rounded focus:outline-none focus:ring-2 focus:ring-indigo-400"></select>

    <label for="rekening" class="block font-semibold mb-1">Nomor Rekening:</label>
    <input type="text" id="rekening" placeholder="Masukkan nomor rekening"
           class="w-full p-2 mb-4 border rounded focus:outline-none focus:ring-2 focus:ring-indigo-400">

    <button onclick="cekRekening()" class="w-full bg-indigo-500 text-white py-2 rounded hover:bg-indigo-600 transition-all duration-200">
      Cek Sekarang
    </button>

    <h3 class="mt-6 font-semibold text-gray-700">Hasil:</h3>
    <pre id="hasil" class="bg-gray-200 p-3 rounded text-sm text-gray-800">Belum dicek.</pre>
  </div>

  <script>
    const API_KEY = "59|duOPH8HB155IQ7xmfzhVXhngOvniL08APtCqswX8bae08bd5";

    // Ambil daftar bank
    async function getBankList() {
      try {
        const res = await fetch("https://storepanda.web.id/api/banklist", {
          headers: {
            "Authorization": `Bearer ${API_KEY}`,
            "Accept": "application/json"
          }
        });
        const data = await res.json();
        const select = document.getElementById("bank");

        data.data.forEach(bank => {
          const opt = document.createElement("option");
          opt.value = bank.code;
          opt.textContent = `${bank.name} (${bank.code})`;
          select.appendChild(opt);
        });
      } catch (err) {
        document.getElementById("hasil").textContent = "Gagal ambil daftar bank.";
      }
    }

    // Cek rekening
    async function cekRekening() {
      const bankCode = document.getElementById("bank").value;
      const accountNumber = document.getElementById("rekening").value;
      const hasil = document.getElementById("hasil");

      if (!accountNumber || !bankCode) {
        hasil.textContent = "Mohon isi semua data.";
        return;
      }

      hasil.textContent = "‚è≥ Sedang mengecek...";

      try {
        const res = await fetch("https://storepanda.web.id/api/inquiry", {
          method: "POST",
          headers: {
          "Authorization": `Bearer ${59|duOPH8HB155IQ7xmfzhVXhngOvniL08APtCqswX8bae08bd5}`,
          "Content-Type": "application/json",
          "Accept": "application/json" // <--- INI YANG KURANG!
          },
          body: JSON.stringify({
            bankCode: bankCode,
            accountNumber: accountNumber
          })
        });

        const json = await res.json();

        if (json.status === 200) {
          hasil.textContent =
            `‚úÖ Rekening ditemukan:\n\n` +
            `üè¶ Bank: ${json.data.bank}\n` +
            `üî¢ Rekening: ${json.data.rekening}\n` +
            `üë§ Nama: ${json.data.name}\n` +
            `üí∞ Saldo: ${json.data.saldo}`;
        } else {
          hasil.textContent = `‚ùå ${json.message || "Rekening tidak ditemukan."}`;
        }
      } catch (err) {
        hasil.textContent = "‚ùå Terjadi kesalahan saat menghubungi server.";
      }
    }

    // Load bank saat halaman dibuka
    getBankList();
  </script>
</body>
</html>
